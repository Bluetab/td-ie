# Changelog

 ## [7.11.0] 2025-10-13

### Added

- [TD-7417] Forcemerge options for elastic index hot swap
  
### Changed

- [TD-7401] Update `td-core` version

## [7.10.0] 2025-09-19

### Added

- [TD-7417] Forcemerge options for elastic index hot swap

## [7.5.0] 2025-04-30

### Added

- [TD-7417] Forcemerge options for elastic index hot swap

### Fixed

- [TD-7226] Enhance SSL configuration handling in production

## [7.4.0] 2025-04-09

### Changed

- License and libraries

## [7.2.0] 2025-03-10

### Added

- [TD-7155] Introduce simple query string query for ingests

## [7.0.0] 2025-01-13

### Changed

- [TD-6911]
  - update Elixir 1.18
  - update dependencies
  - update Docker RUNTIME_BASE=alpine:3.21
  - remove unused dependencies
  - remove swagger
- [TD-5713]
  - Updates analyzers to take `asciifolding` and multiple languages into account.
  - `search_as_you_type` type in concept name.
  - Defines scope for native and dynamic fields search.
  - Use query data in `ElasticDocumentProtocol` to build queries.

## [6.16.0] 2024-12-16

### Added

- [TD-6982] Added SSL and ApiKey configuration for Elasticsearch

## [6.13.0] 2024-10-15

### Changed

- [TD-6773] Update td-df-lib, td-cache and td-core
- [TD-6617] Update td-df-lib and td-core

## [6.9.2] 2024-07-29

### Added

- [TD-6734] Update td-df-lib and td-core

## [6.9.1] 2024-07-26

### Added

- [TD-6733] Update td-df-lib and td-core

## [6.9.0] 2024-07-26

### Changed

- [TD-6602], [TD-6723] Update td-cache, td-core and td-df-lib

## [6.8.1] 2024-07-18

### Added

- [TD-6713] Update td-df-lib and td-core

## [6.8.0] 2024-07-03

### Added

- [TD-6499] Add Ingest Execution content data origin

## [6.7.0] 2024-06-13

### Fixed

- [TD-6561]
  - Standardise aggregations limits
  - Use keyword list for elastic search configuration√ß
- [TD-6402] IndexWorker improvement
- [TD-6440] Update td-df-lib

## [6.5.0] 2024-04-30

### Added

- [TD-6535] Update Td-core for Elasticsearch reindex improvements and fix index deletion by name
- [TD-6492] Update td-df-lib to enrich hierarchy path

### Fixed

- [TD-5495] Foreing keys columns should match original ID columns in all tables

## [6.4.0] 2024-04-09

### Added

- [TD-6507] Add Elastic bulk page size for enviroment vars and update core lib
- [TD-6527] Add LICENSE file

### Fixed

- [TD-6424] Fixed switch on fields aren't translated when uploading and
  downloading

### Fixed

- [TD-6401] Fixed Content aggregations have a maximum of 10 values

## [6.3.0] 2024-03-18

### Added

- [TD-4110] Allow structure scoped permissions management

## [6.2.0] 2024-02-26

### Added

- [TD-6243] Support for deleting Elasticsearch indexes

### Fixed

- [TD-6425] Ensure SSL if configured for release migration

## [5.20.0] 2023-12-19

### Changed

- [TD-6234] Use td-core-lib for elastic search and reindex

## [5.18.0] 2023-11-13

### Changed

- [TD-6177] Update td-df-lib to fix format field

## [5.17.0] 2023-10-31

### Added

- [TD-6103] Allow empty option for domain type filter

## [5.13.1] 2023-09-14

### Fixed

- [TD-6051] Searchable option for filters

## [5.13.0] 2023-09-05

### Changed

- [TD-5913] Update td-df-lib to fix depends validation

## [5.10.0] 2023-07-06

### Changed

- [TD-5912] `.gitlab-ci.yml` adaptations for develop and main branches

## [5.9.0] 2023-06-20

### Added

- [TD-5770] Add database TSL configuration

## [5.8.0] 2023-06-05

### Added

- [TD-3916] Update td-df-lib version
- [TD-5787] Add multi_match param in elastic query for Boost option

### Changed

- [TD-5697] Use `HierarchyCache.get_node/1`

## [5.6.0] 2023-05-09

### Added

- [TD-3807] search filters returns types

## [5.5.0] 2023-04-18

### Added

- [TD-5297] Added `DB_SSL` environment variable for Database SSL connection

## [5.3.0] 2023-03-13

### Added

- [TD-3806] Hierarchy template cache implementation

## [4.56.0] 2022-11-28

### Added

- [TD-5289] Elasticsearch 7 compatibility

## [4.54.0] 2022-10-31

### Changed

- [TD-5284] Phoenix 1.6.x

## [4.52.0] 2022-10-03

### Added

- [TD-4903] Include `sobelow` static code analysis in CI pipeline

## [4.50.0] 2022-09-05

### Changed

- [TD-5091] Dynamic `domain` fields are now integer ids instead of embedded
  documents

## [4.48.0] 2022-07-26

### Fixed

- [TD-5011] `TemplateCache.list/0` was returning duplicate entries

### Changed

- [TD-3614] Support for access token revocation

## [4.46.0] 2022-06-20

### Changed

- [TD-4739] Validate dynamic content for safety to prevent XSS attacks

## [4.45.0] 2022-06-06

### Changed

- Updated dependencies

## [4.40.0] 2022-03-14

### Changed

- [TD-2501] Database timeout and pool size can now be configured using
  `DB_TIMEOUT_MILLIS` and `DB_POOL_SIZE` environment variables
- [TD-4461] Avoid reindexing when a domain is modified
- [TD-4491] Compatibility with new permissions model

## [4.36.0] 2022-01-24

### Added

- [TD-4312]
  - Autogenerated template identifier field
  - Prevent identifier change if a new ingest version is created
  - Mapping to search by identifier

## [4.31.0] 2021-11-02

### Added

- [TD-4124] Dependent domain field in td_df_lib

## [4.28.0] 2021-09-20

### Added

- [TD-3971] Template mandatory dependent field

### Fixed

- [TD-4037] change the limit on the taxonomy in aggregations

## [4.27.0] 2021-09-07

### Changed

- [TD-3973] Update td-df-lib for default values in swith fields

## [4.25.0] 2021-07-26

### Changed

- Updated dependencies

## [4.24.0] 2021-07-13

### Added

- [TD-3230] Taxonomy aggregations with enriched information

## [4.21.0] 2021-05-31

### Changed

- [TD-3753] Build using Elixir 1.12 and Erlang/OTP 24
- [TD-3502] Update td-cache and td-df-lib

## [4.20.0] 2021-05-17

### Changed

- Security patches from `alpine:3.13`
- Update dependencies

## [4.19.0] 2021-05-04

### Added

- [TD-3628] Force release to update base image

## [4.17.0] 2021-04-05

### Changed

- [TD-3445] Postgres port configurable through `DB_PORT` environment variable

## [4.15.0] 2021-03-08

### Changed

- [TD-3341] Build with `elixir:1.11.3-alpine`, runtime `alpine:3.13`

## [4.14.0] 2021-02-22

### Changed

- [TD-3245] Tested compatibility with PostgreSQL 9.6, 10.15, 11.10, 12.5 and
  13.1. CI pipeline changed to use `postgres:12.5-alpine`.

## [4.13.0] 2021-02-08

### Added

- [TD-3263] Use HTTP Basic authentication for Elasticsearch if environment
  variables `ES_USERNAME` and `ES_PASSWORD` are present

## [4.12.0] 2021-01-25

### Changed

- [TD-3163] Auth tokens now include `role` claim instead of `is_admin` flag
- [TD-3182] Allow to use redis with password

## [4.11.0] 2021-01-11

### Changed

- [TD-3170] Build docker image which runs with non-root user

## [4.10.0] 2020-12-14

### Added

- [TD-2486] Domain selector support (type `domain` in template)

## [4.9.0] 2020-11-30

### Added

- [TD-3089] Widget and type `copy` on df

## [4.6.0] 2020-10-19

### Added

- [TD-2485]:
  - Enrich template fields from cache
  - Mappings for system type of templates

## [4.0.0] 2020-07-01

### Changed

- [TD-2585] Include `domain_ids` in payload of audit events
- [TD-2637] Audit events are now published to a Redis stream
- [TD-2687] Remove `email` and `is_admin` from embedded user data in ingest
  responses

### Removed

- Unused route `/api/ingests/comments` and related modules (comments are
  currently supported by td-bg)

## [3.24.0] 2020-06-15

### Changed

- [TD-2261] Update cache to retrieve new attribute `deleted_at` from structures

## [3.23.0] 2020-06-01

### Changed

- [TD-2629] Update td-df-lib to omit template fields of type `image` on indexing
- [TD-2492] Update td-df-lib to include new numeric template types

## [3.22.0] 2020-05-18

### Added

- [TD-2586] Fields `last_execution` and `execution_status` on search

### Changed

- [TD-2490] td-cache: Updated Taxonomy information on domain update

## [3.19.0] 2020-04-06

### Added

- [TD-2364] Reindex ingests on domain update

## [3.16.0] 2020-02-25

### Added

- [TD-2328] Include `external_id` in ingests domain response

### Changed

- [TD-940] Updated to Elixir 1.10

## [3.15.1] 2020-02-19

### Fixed

- [TD-2344] Added missing flatten of df fields on search mapping

## [3.9.0] 2019-10-28

### Changed

- [TD-2180] Take into account sort parmas on ingests' search

### Fixed

- [TD-2179] When changing the status of an ingest we retrieve domain information

## [3.8.0] 2019-10-14

### Changed

- [TD-1721] Reindex automatically when a template changes
  - Breaking change: New environment variable ES_URL replaces existing
    ES_HOST/ES_PORT

### Fixed

- [TD-2178] Use ingest version id instead of ingest id when reindexing

## [3.7.0] 2019-09-31

### Added

- [TD-1625] Support for df `table` type
- [TD-1837] Ingest version embedded links

## [3.6.0] 2019-09-16

### Fixed

- [TD-2078] Preserve order of ingests in search response

## [3.5.1] 2019-09-03

### Fixed

- [TD-2081] Event stream consumer did not respect redis_host and port config
  options

## [3.5.0] 2019-09-02

### Added

- [TD-2053] Create event on ingest publish

### Fixed

- [TD-1993] Restrict dynamic index mappings to "ie" scope

## [3.4.0] 2019-08-19

### Added

- [TD-2045] File records in ingest_executions
- [TD-2036] Ability to check create permission on ingest

## [3.3.0] 2019-08-05

### Added

- [TD-1560] Enriched description field in template content

### Changed

- [TD-1985] Type of template field user with an aggregation size of 50
- [TD-1995] add new file description in ingest_executions
- [TD-2037] Bump cache version due to lack of performance

## [3.2.0] 2019-07-24

### Removed

- [TD-1994] Remove deprecated relations (parent_id, related_to) from model

### Changed

- [TD-2002] Update td-cache and delete permissions list from config

## [3.1.0] 2019-07-08

### Changed

- [TD-1618] Cache improvements (use td-cache instead of td-perms)
- [TD-1924] Use Jason instead of Poison for JSON encoding/decoding

## [3.0.0] 2019-06-25

### Changed

- [TD-1893] Use CI_JOB_ID instead of CI_PIPELINE_ID

## [2.21.0] 2019-06-04

### Changed

- [TD-1789] update ES mappings according to template format

## [2.20.0] 2019-05-27

### Fixed

- [TD-1774] Newline is missing in logger format

### Changed

- Updated dependencies: phoenix 1.4, ecto 3.0, td_df_lib 2.19.3, td_perms 2.19.1

## [2.16.0] 2019-04-02

### Added

- [TD-1571] Elixir's Logger config will check for EX_LOGGER_FORMAT variable to
  override format
- [TD-1573] On IngestExecutions adds file_name and file_size and makes
  end_timestamp not required

## [2.12.2] 2019-01-29

### Fix

- [TD-1371] Fix end-point to add executions by name when there are many versions

## [2.12.1] 2019-01-28

### Fix

- [TD-1371] Fix end-point to add executions by name

## [2.12.0] 2019-01-15

### Added

- [TD-1371] Added end-point to add executions by name

## [2.11.0] 2019-01-15

### Added

- Added support for Ingest Executions

## [0.0.3] 2018-12-07

### Added

- New post endpoint which recieves some params in order to narrow the retrieved
  filters

## [0.0.2] 2018-12-03

### Added

- Adding new permissions to td_perms library

## [0.0.1] 2018-11-30

### Added

- Release version
